import loggingimport sqlite3from datetime import datetimefrom Classes.item import Itemclass DataBase:    def __init__(self, db_path):        self.db_path = db_path        self.__connection = sqlite3.connect(self.db_path)        self.__cursor = self.__connection.cursor()    def create_connection(self):        try:            self.__connection = sqlite3.connect(self.db_path)            self.__cursor = self.__connection.cursor()            return self.__connection        except sqlite3.Error as e:            logging.error(f"Error connecting to database: {e}")            return None    def create_table(self, table_name: str):        self.__cursor.execute(f'''CREATE TABLE IF NOT EXISTS {table_name} (                                                article  NOT NULL,                        title TEXT NOT NULL,                        price INTEGER NOT NULL                    )''')    def close(self):        self.__cursor.close()        self.__connection.close()    def update_db(self, info_from_google_sheet: list):        try:            con = self.create_connection()            if not con:                logging.error("Failed to establish connection.")                return            self.__cursor = con.cursor()            for elem in info_from_google_sheet:                if isinstance(elem, dict) and 'article' in elem and 'title' in elem and 'price' in elem:                    item = Item(elem['article'], elem['title'], elem['price'])                else:                    logging.error(f"Invalid item format: {elem}")                    continue                self.__cursor.execute("SELECT * FROM WACOM WHERE article = ?", (item.article,))                existing_item = self.__cursor.fetchone()                if existing_item:                    new_price = elem['price']                    self.__cursor.execute("UPDATE WACOM SET price = ? WHERE article = ?", (new_price, item.article))                else:                    self.__cursor.execute("INSERT INTO WACOM (article, title, price) VALUES (?, ?, ?)",                                          (item.article, item.title, item.price))                con.commit()            current_datetime = datetime.now()            formatted_datetime = current_datetime.strftime('%Y-%m-%d %H:%M:%S')            logging.info(f"Database was successfully updated: {formatted_datetime}")        except Exception as e:            logging.error(f"Database updating error: {e}")            raise        finally:            if con:                con.close()                logging.info("Connection closed.")    def get_info_from_db(self):        con = self.create_connection()        cur = con.cursor()        cur.execute('''SELECT * FROM WACOM''')        all_from_table = cur.fetchall()        items_from_db = []        for elem in all_from_table:            item = Item.from_tuple(elem)            items_from_db.append(item)            yield item        self.close()        return items_from_db